<!DOCTYPE html>
<html dir="rtl" lang="ar">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <title>
    بيت جبر - Bait gabr
  </title>
  <script src="../css/tailwindcss.js">
  </script>
     <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
  <link href="../css/sidebar.css" rel="stylesheet"/>
  <style>
   /* Custom scrollbar for the right sidebar if needed */
    ::-webkit-scrollbar {
      width: 6px;
    }
    ::-webkit-scrollbar-thumb {
      background-color: #fbbf24;
      border-radius: 10px;
    }
      @import url('https://fonts.googleapis.com/css2?family=Almarai&display=swap');
    body {
      font-family: 'Almarai', sans-serif;
    }
   @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');
    body {
      font-family: 'Cairo', sans-serif;
    }
  </style>
 </head>
 <body class="bg-[#f7f7f7] m-0 p-0">
  <header class="bg-black text-white">
   <div class="max-w-[1200px] mx-auto flex items-center justify-between px-4 py-2 text-xs sm:text-sm">
    <div class="flex items-center space-x-2 space-x-reverse">
     <div class="flex items-center justify-center w-5 h-5 rounded-full bg-white text-black text-[10px] font-semibold">
      0
     </div>
     <span>
      0,00 EGP
     </span>
    </div>
    <nav class="flex items-center space-x-4 space-x-reverse text-white text-sm">
     <button aria-label="Cart" class="hover:text-yellow-400" onclick="show_sidebar(); show_cart_footer();">
      <i class="fas fa-shopping-cart">
      </i>
     </button>
     <button aria-label="Favorites" class="hover:text-yellow-400">
      <i class="far fa-heart">
      </i>
     </button>
     <button aria-label="Notifications" class="hover:text-yellow-400">
      <i class="far fa-bell">
      </i>
     </button>
     <a class="hover:text-yellow-400" href="/login">
      دخول / تسجيل
     </a>
     <button aria-label="User" class="hover:text-yellow-400">
      <i class="far fa-user">
      </i>
     </button>
    </nav>
   </div>
  </header>
    <div class="bg-black">
   <div class="max-w-[1200px] mx-auto flex items-center justify-between px-4 py-3">
    <a class="flex items-center space-x-2 space-x-reverse" href="#">
     <img alt="Bait gabr  logo icon, golden hexagonal shape with electric bolt inside" class="w-15 h-15" height="80" src="../imgs/logo-white.jpg" style="border-radius:50pc;" width="80"/>
     <span class="text-yellow-400 font-extrabold text-2xl select-none" style="font-family: 'Almarai', sans-serif;color: rgb(155, 78, 23);">
      Bait 
      <span class="text-white">
       gabr
      </span>
     </span>
    </a>
    <form class="flex-1 max-w-[600px] mx-auto">
     <label class="sr-only" for="search">
      البحث عن المنتجات
     </label>
     <div class="relative">
         <input class="w-full rounded-full py-2 pr-4 pl-12 text-black text-sm focus:outline-none" id="search-product" placeholder="البحث عن المنتجات" type="search"/>
      <button aria-label="Search" class="absolute left-3 top-1/2 -translate-y-1/2 text-black" onclick="search_product();" type="button">
       <i class="fas fa-search">
       </i>
      </button>
     </div>
    </form>
   </div>
  </div>
  <!-- Navigation bar below -->
  <nav id="lest_category" class="max-w-[1200px] mx-auto px-4 py-2 bg-[#f9f8f1] flex flex-wrap gap-2 text-xs sm:text-sm font-semibold text-black select-none">
   <button aria-current="true" class="flex items-center gap-1 px-3 py-1 rounded-md bg-yellow-100 text-yellow-500" data-slide="0" type="button">
    <i class="fas fa-home text-base">
    </i>
    الرئيسية
   </button>
  </nav>
  <!-- Header Section -->
  <header class="relative w-full h-40 sm:h-48 md:h-56 lg:h-64 bg-gradient-to-b from-[#2a2a2a] to-[#9b4e17] flex items-center justify-start pl-10">
   <h1 class="text-[#2a2a2a] text-4xl sm:text-5xl md:text-6xl font-extrabold leading-tight text-right" id="page-title">

   
   </h1>
  
  </header>
  <!-- Breadcrumb -->
  <nav class="text-[#6b6b6b] text-sm sm:text-base px-6 py-4 flex justify-start space-x-1">
   <a class="hover:underline" href="/" id="home-link">
    الرئيسية
   </a>
   <span>
    /
   </span>
   <span>
    <a class="hover:underline" href="#" >
     قسم
   </a>
   </span>
   <span>
    /
   </span>
   <span class="font-semibold">
    <a href="#" id="section-link">

    </a>
   </span>
  </nav>
  <!-- Categories -->
  <section class="flex justify-center gap-6 sm:gap-10 px-4 sm:px-10 py-8 flex-wrap">
   <!-- Item 1 -->
  </section>


  <div class="max-w-[1300px] mx-auto p-4 flex flex-col lg:flex-row gap-6">
   <!-- Left content: Filter dropdown and product cards -->
   <div class="flex-1 space-y-4">
    <!-- Filter dropdown -->
    <div>
     <button aria-expanded="false" aria-haspopup="listbox" class="border border-gray-300 rounded-md px-4 py-2 text-gray-800 font-semibold flex items-center gap-1" type="button">
      التصنيف حسب الحدث
      <svg aria-hidden="true" class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
       <path d="M19 9l-7 7-7-7" stroke-linecap="round" stroke-linejoin="round">
       </path>
      </svg>
     </button>
    </div>
    <!-- Products grid -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6" style="overflow: auto;" id="product_list">
     
    
    </div>
   </div>
   <!-- Right sidebar -->
   <aside aria-label="Sidebar with price and categories" class="w-full max-w-[320px] bg-white rounded-xl border border-gray-200 p-6 flex flex-col gap-6">
    <!-- Results text -->
    <p class="text-gray-500 text-sm text-right">
     عرض 1-12 من 214 نتيجة
    </p>
    <!-- Price filter -->
   <section aria-labelledby="price-filter" class="space-y-3">
  <h2 class="font-bold text-lg text-gray-900 text-right border-b border-gray-200 pb-2" id="price-filter">
    السعر
  </h2>
  <div class="flex flex-col gap-2 px-4">
    <!-- Min Price -->
    <label for="minPrice" class="text-gray-700 text-sm text-right">السعر من:</label>
    <input 
      type="range" 
      id="minPrice" 
      min="140" 
      max="30500" 
      value="140" 
      step="100" 
      class="w-full h-2 bg-yellow-200 rounded-lg appearance-none cursor-pointer accent-yellow-400"
      aria-label="تحديد السعر الأدنى"
    />
    <div class="text-right text-sm text-yellow-600 font-semibold" id="minPriceValue">140 EGP</div>
    <!-- Max Price -->
    <label for="maxPrice" class="text-gray-700 text-sm text-right">السعر إلى:</label>
    <input 
      type="range" 
      id="maxPrice" 
      min="140" 
      max="30500" 
      value="30500" 
      step="100" 
      class="w-full h-2 bg-yellow-200 rounded-lg appearance-none cursor-pointer accent-yellow-400"
      aria-label="تحديد السعر الأعلى"
    />
    <div class="text-right text-sm text-yellow-600 font-semibold" id="maxPriceValue">30,500 EGP</div>
  </div>
  <button 
    class="bg-yellow-400 hover:bg-yellow-500 text-gray-900 font-semibold rounded-md py-2 px-4 w-full max-w-[140px] text-center transition mt-3"
    type="button"
    onclick="applyPriceFilter()"
  >
    ترشيح
  </button>
</section>
    <!-- Categories -->
    <section aria-labelledby="categories" class="space-y-3">
     <h2 class="font-bold text-lg text-gray-900 text-right border-b border-gray-200 pb-2" id="categories">
      الأقسام
     </h2>
     <!-- Category group -->
     <div class="space-y-1">
      <button aria-controls="bath-kitchen-list" aria-expanded="true" class="flex items-center justify-between w-full text-yellow-500 font-semibold text-right" type="button">
       <span>
        الحمام و المطبخ
       </span>
       <i class="fas fa-chevron-up text-yellow-500">
       </i>
      </button>
      <ul class="text-gray-600 text-sm list-disc list-inside space-y-1" id="bath-kitchen-list">
       <li>
        احواض
       </li>
       <li>
        اكسسوارات الحمام
       </li>
       <li>
        البانيوهات
       </li>
       <li>
        الدش
       </li>
       <li>
        خلطات
       </li>
       <li>
        مرحاض
       </li>
       <li>
        وحدات
       </li>
       <li>
        السباكة
       </li>
      </ul>
     </div>
     <!-- Another category group collapsed -->
     <div class="space-y-1">
      <button aria-controls="other-list" aria-expanded="false" class="flex items-center justify-between w-full text-gray-900 font-semibold text-right" type="button">
       <span>
        أقسام أخرى
       </span>
       <i class="fas fa-chevron-down text-yellow-500">
       </i>
      </button>
     </div>
    </section>
   </aside>
  </div>
 <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
  <style>
   @import url('https://fonts.googleapis.com/css2?family=Almarai&display=swap');
    body {
      font-family: 'Almarai', sans-serif;
    }
  </style>
  <footer class="pt-10 pb-6 px-6 md:px-20 bg-[#030201] text-white">
   <div class="max-w-[1200px] mx-auto">
    <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-y-8 gap-x-6 text-xs leading-6">
     <div>
      <h3 class="font-semibold mb-3">
       الاضاءة
      </h3>
      <ul class="space-y-2">
       <li>
        لمبات
       </li>
       <li>
        اضاءة سقف و سبوتات
       </li>
       <li>
        نجف
       </li>
       <li>
        مصابيح طوارئ
       </li>
       <li>
        اضاءة حائط
       </li>
       <li>
        اكسسوارات الاضاءة
       </li>
       <li>
        اضاءة خارجية
       </li>
      </ul>
     </div>
     <div>
      <h3 class="font-semibold mb-3">
       الحمام والمطبخ
      </h3>
      <ul class="space-y-2">
       <li>
        اكسسوارات الحمام
       </li>
       <li>
        البانيوهات
       </li>
       <li>
        خلطات
       </li>
       <li>
        الدش
       </li>
       <li>
        احواض
       </li>
       <li>
        مرحاض
       </li>
      </ul>
     </div>
    </div>
    <hr class="border-t border-[#3a2f1f] my-8"/>
    <div class="flex flex-wrap justify-between items-center gap-4 max-w-[1200px] mx-auto">
     <div class="flex flex-wrap gap-4">
      <a class="w-12 h-12 flex justify-center items-center border border-gray-600 rounded-md text-white text-xl hover:text-yellow-500 hover:border-yellow-500 transition" href="https://www.instagram.com/baitgabr">
       <i class="fab fa-instagram">
       </i>
      </a>
      <a class="w-12 h-12 flex justify-center items-center border border-gray-600 rounded-md text-white text-xl hover:text-yellow-500 hover:border-yellow-500 transition" href="https://www.facebook.com/share/14RPuDqnZWB/">
       <i class="fab fa-facebook-f">
       </i>
      </a>
      <a class="w-12 h-12 flex justify-center items-center border border-gray-600 rounded-md text-white text-xl hover:text-yellow-500 hover:border-yellow-500 transition" href="https://wa.me/01228642140">
       <i class="fab fa-whatsapp">
       </i>
      </a>
      <a class="flex items-center border border-gray-600 rounded-md px-4 text-xs text-white gap-2 hover:text-yellow-500 hover:border-yellow-500 transition" href="tel:01228642140">
       <i class="fas fa-mobile-alt">
       </i>
        01228642140
      </a>
      <a class="flex items-center border border-gray-600 rounded-md px-4 text-xs text-white gap-2 hover:text-yellow-500 hover:border-yellow-500 transition" href="mailto:gabrgroup1@gmail.com">
       <i class="far fa-envelope">
       </i>
       gabrgroup1@gmail.com
      </a>
     </div>
    </div>
    <hr class="border-t border-[#3a2f1f] my-6"/>
    <!-- <div class="flex flex-wrap justify-start gap-4 text-[10px] text-gray-400 max-w-[1200px] mx-auto">
     <a class="hover:text-yellow-500 transition" href="#">
      من نحن
     </a>
     <a class="hover:text-yellow-500 transition" href="#">
      اتصل بنا
     </a>
     <a class="hover:text-yellow-500 transition" href="#">
      سياسة الخصوصية
     </a>
     <a class="hover:text-yellow-500 transition" href="#">
      سياسة الإرجاع والاسترداد
     </a>
    </div> -->
    <p class="text-[10px] text-gray-400 mt-4 max-w-[1200px] mx-auto">
     © جميع الحقوق محفوظة للإكترادي 2025.
    </p>
   </div>
 <aside class="fixed top-0 left-0 h-full w-72 bg-white/70 backdrop-blur z-50 flex flex-col" id="sidebar" style="display: none;">
   <!-- Header -->
   <header class="flex items-center justify-between p-4 border-b border-gray-200 bg-transparent">
    <h2 class="text-base font-semibold">
     عربة التسوق
    </h2>
    <button aria-label="إغلاق" class="text-sm font-normal text-gray-700 flex items-center gap-1" id="close-btn" type="button">
     إغلاق
     <i class="fas fa-times">
     </i>
    </button>
   </header>
   <!-- Cart Items -->
              <div id="shoping_icone" onclick="show_sidebar(); show_cart_footer();" class="fixed bottom-6 right-6 bg-yellow-400 text-black p-4 rounded-full shadow-lg cursor-pointer hidden z-50" title="تسوق الآن">
  <i class="fas fa-shopping-cart fa-lg"></i>
</div>
   <div class="flex flex-col gap-4 p-4" id="cart-items" style="height: calc(100% - 110px);">
   <div class=""  id="order-detils" style="max-height: 80%;overflow: auto;">

   </div>
   <!-- Footer -->
   <footer class="p-4 border-t border-gray-200">
    <div class="flex justify-between items-center mb-3 text-xs font-semibold text-yellow-600">
     <span>
      المجموع الكلي:
     </span>
     <span id="total-price">
     0
     </span>
     
    </div>
    <!-- <button class="w-full mb-2 py-2 bg-yellow-500 text-black text-xs font-semibold rounded" type="button">
     شاهد محتوى العربة
    </button> -->
    <a href="/checkout">
    <button class="w-full py-2 bg-yellow-500 text-black text-xs font-semibold rounded" type="button">
     اتمام الطلب
    </button>
    </a>
   </footer>
  </aside>
   <script src="../js/sidebar.js"></script>
  </footer>
  <script>
     const minPrice = document.getElementById('minPrice');
  const maxPrice = document.getElementById('maxPrice');
  const minPriceValue = document.getElementById('minPriceValue');
  const maxPriceValue = document.getElementById('maxPriceValue');

  function formatNumber(num) {
    return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
  }
  // Update displayed values
  function updateMinPrice() {
    let minVal = parseInt(minPrice.value);
    let maxVal = parseInt(maxPrice.value);
    if (minVal > maxVal) {
      minVal = maxVal;
      minPrice.value = minVal;
    }
    minPriceValue.textContent = `${formatNumber(minVal)} EGP`;
  }
  function updateMaxPrice() {
    let minVal = parseInt(minPrice.value);
    let maxVal = parseInt(maxPrice.value);
    if (maxVal < minVal) {
      maxVal = minVal;
      maxPrice.value = maxVal;
    }
    maxPriceValue.textContent = `${formatNumber(maxVal)} EGP`;
  }
  minPrice.addEventListener('input', updateMinPrice);
  maxPrice.addEventListener('input', updateMaxPrice);
  // Initialize display
  updateMinPrice();
  updateMaxPrice();
async  function applyPriceFilter () {
    const section = document.getElementById('page-title').textContent;
    const from = minPrice.value;
    const to = maxPrice.value;
   const urly2 = new URL(window.location.href);
    const apisn =Number(urly2.searchParams.get('a') );
    const api_url2 =urly2.origin;
    const products = await search_product_price(from,to,section);
    if(products.length == 0) {
     alert(' للاسف لا توجد منتجات تتناسب مع ترشيحك...! ')
    }else{
        document.getElementById('product_list').innerHTML = ``
    }
    for (const product of products) {
                  const prices = JSON.parse(product.price)
                  const firstPrice = ( Object.values(prices)[0]);
                  const prices2 = JSON.stringify(firstPrice).split('-')[0].replace(/[^\d.,]/g, '').trim()

         if(product.sections_code == apisn && product.products_Status == 'Active') {
             document.getElementById('page-title').innerHTML = product.sections_name;
             document.getElementById('section-link').href = api_url2;
              document.getElementById('section-link').innerHTML = product.sections_name;
             document.getElementById('home-link').href = api_url2;

        document.getElementById('product_list').innerHTML += `
             <div class="bg-white rounded-lg border border-gray-200 p-3 relative flex flex-col" style="min-width: 280px;max-height: 400px;">
      <button aria-label="Add to favorites" class="absolute top-3 right-3 bg-white rounded-md p-2 text-gray-800 hover:text-red-600">
       <i class="far fa-heart">
       </i>
      </button>

      <div class="relative rounded-lg overflow-hidden">
       <img alt="${product.description}" class="w-full h-auto object-cover rounded-lg" style="width:300px;"  loading="lazy" src="${product.image_url}" width="300"/>
      </div>
      <h3 class="mt-3 font-bold text-sm leading-tight text-gray-900">
         ${product.name_product}
      </h3>
      <!-- Rating stars -->
      <div class="mt-1 flex space-x-1 justify-start rtl:space-x-reverse text-yellow-400 text-lg">
       <i class="far fa-star">
       </i>
       <i class="far fa-star">
       </i>
       <i class="far fa-star">
       </i>
       <i class="far fa-star">
       </i>
       <i class="far fa-star">
       </i>
      </div>
      <!-- Price -->
      <p class="mt-2 font-semibold text-base text-gray-900">
       EGP ${prices2} ---
       <span class="text-gray-500 mx-1">
       </span>
      <span class="text-gray-500">
       <i class="fas fa-tag">
       </i>
          <span class="text-lg text-red-600 font-semibold line-through" >
          ${Math.floor(Number(prices2) + Number(10/100*prices2))} EGP
          </span>
        </span>
      </p>
      <div class="absolute top-3 left-3 bg-red-600 text-white text-x font-semibold rounded px-2 py-1 select-none" style="border-radius:50px;" >
                   -20%
                  </div>
      <!-- Button -->

       </i>
      </button>
            <button class="mt-3 bg-[#9b4e17]-300 hover:bg-yellow-500 text-gray-900 font-semibold rounded-md py-2 flex items-center justify-center gap-2" type="button" >
      <a href="${api_url2}/item-profile?product=${product.products_code}" class="text-blue-500 hover:underline">  عرض التفاصيل  </a>
       <i class="fas fa-info-circle">
       </i>
      </button>
     </div>
     `
    };
     }
  } 
  
  const search_product_price= async (from,to,section)=>{
    const search= document.getElementById('search-product').value;
    console.log(search);
         const dataform={
                    'from':from,
                    'to':to,
                    'section':section
                    }  
                try {
               const response =  await fetch(api_search+"/search_product_price", {
                        method:"post",
                        body:JSON.stringify(dataform),
                        headers:{
                            'Content-Type':'application/json',
                        }
                    });

                    const orders = await response.json()
                    // console.log(orders);
                    return orders;
                }
            catch (error) {
                console.error('Error sending data:', error);
            }
}

  </script>
  <script src="../js/search.js"></script>
  <script src="../js/item.js"></script>
  <script src="../js/sidebar.js"></script>
 </body>
</html>